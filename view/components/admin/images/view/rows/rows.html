{% set image = createModel('Image','image').where('id','>',0) %}
{% set user_filter = searchValue('user_id','images') %}
{% if user_filter is not empty %}
    {% set image = image.userImagesQuery(user_filter) %}
{% endif %}
{{ createSearch('file_name','images','ilike:{value}%') }}
{% set image = applySearch(image,'images') %}
{% set items = paginate(image,'images')  %}
{% if items.getItems()|length == 0 %}
    <tr>
        <td colspan="9">{{ labels.empty }}</td>
    </tr>
{% endif %}
{% for item in items.getItems() %}  
    <tr id="{{ item.uuid }}">             
        <td>            
            <button 
                mountTo=""
                component=""
                class="{{ theme.buttons.icon }} details-button" 
                uuid="{{ item.uuid }}" 
                title="{{ labels.details }}">
                {{ component('icons~info',theme.icons.menu,'svg') }}
            </button>                       
            <button 
                class="{{ theme.buttons.icon }} thumbnails-button" 
                uuid="{{ item.uuid }}" 
                title="{{ labels.thumbnails }}">
                <i class="icon images"></i>
            </button>   
            <button class="ui icon mini basic button edit-button" uuid="{{ item.uuid }}" title="{{ labels.edit }}">
                <i class="icon edit"></i>
            </button>     
            <button class="ui icon mini basic button image-relations-button" uuid="{{ item.uuid }}" title="{{ labels.relations }}">
                <i class="icon blue project diagram"></i>
            </button>       
            <a 
                title="{{ labels.download }}"
                href="{{ url('/api/image/download/' ~ item.uuid) }}" 
                class="ui icon mini basic button">
                <i class="icon download"></i>
            </a>   
            {% if item.deny_delete != true %}                                      
            <button class="ui icon mini basic button delete-button" uuid="{{ item.uuid }}" data-title="{{ item.file_name }}">
                <i class="icon trash orange"></i>
            </button>  
            {% endif %}       
        </td>  
        <td class="self-center">
            {% set thumbnail = item.thumbnail(64,64) %}
            {% if thumbnail is not empty %}
                <img 
                    src="{{ url(thumbnail.src) }}" 
                    class="rounded" 
                    title="{{ item.mime_type }}">
            {% else %}
                <div class="rounded">
                    {{ component('icons~image',{ size: 'h-full w-full', color: 'gray-400' },'svg') }}                   
                </div>
            {% endif %}
        </td>
        <td>
            {{  component('system:admin.status.dropdown',{ 
                    status: item.status, 
                    uuid: item.uuid, 
                    skip: [2,3,4,5,6] 
                }) 
            }} 
        </td>    
        <td>
            {{ item.date_created|dateFormat }}
        </td>       
        <td class="self-center">
            {% if item.width is not empty and item.height is not empty %}
                {{ item.width }} x {{ item.height }}
            {% else %}
                ..
            {% endif %}
        </td>
        <td class="flex flex-row items-center" title="{{ item.file_name }}">  
            {% if item.deny_delete == true %}
                <div class="badge badge-sm badge-outline">{{ labels.delete }}</div>
            {% endif %}  
            {% if item.private == true %}
                <span title="{{ labels.protected }}">
                    {{ component('icons~lock',theme.icons.menu,'svg') }}
                </span>
            {% else %}
                <span title="{{ labels.public }}">
                    {{ component('icons~lock',theme.icons.menu,'svg') }}           
                </span>
            {% endif %}    
            <div title="{{ item.file_size|fileSize }}">
                {{ item.file_name|baseName }}
            </div>   
        </td>                                           
        <td>{{ item.user.user_name }}</td>                                               
    </tr>
{% endfor %}
